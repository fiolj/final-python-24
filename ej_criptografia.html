<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Análisis criptográfico de texto &mdash; documentación de Examen Final IPyCI - 16/04/2024</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/rtd_overrides.css" type="text/css" />
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=ad33c3fb"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/translations.js?v=efdbd0b9"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="Modalidad del examen" href="lineamientos.html" />
    <link rel="prev" title="Manejo y análisis de datos" href="ej_manejodatos.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Examen Final IPyCI
              <img src="_static/logo.svg" class="logo" alt="Logotipo"/>
          </a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Problemas:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ej_crucigrama.html"> Crucigrama</a></li>
<li class="toctree-l1"><a class="reference internal" href="ej_fifa.html"> Futbol codificado</a></li>
<li class="toctree-l1"><a class="reference internal" href="ej_manejodatos.html"> Manejo y análisis de datos</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"> Análisis criptográfico de texto</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Información:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="lineamientos.html"> Modalidad del examen</a></li>
<li class="toctree-l1"><a class="reference internal" href="pmp.html"> Preguntas muy preguntadas</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Examen Final IPyCI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"> Análisis criptográfico de texto</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/ej_criptografia.rst.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="icono-analisis-criptografico-de-texto">
<h1><a class="reference internal" href="_images/user-secret.svg"><img alt="icono" src="_images/user-secret.svg" width="52" /></a> Análisis criptográfico de texto<a class="headerlink" href="#icono-analisis-criptografico-de-texto" title="Link to this heading"></a></h1>
<p>Se tiene una serie de mensajes cifrados los cuales se quieren descifrar.
Gracias a nuestro servicio de inteligencia sabemos que la técnica de
cifrado utilizada es la siguiente. Los mensajes sólo contienen
caracteres de la A a la Z y espacios entre palabras, no se utilizan
signos diacríticos (acentos o la virgulilla de la Ñ) ni signos de
puntuación. A todos estos caracteres se les asigna un número entero del
0 al 26 de acuerdo a la siguiente tabla:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Letra</p></td>
<td><p>A</p></td>
<td><p>B</p></td>
<td><p>C</p></td>
<td><p>D</p></td>
<td><p>E</p></td>
<td><p>F</p></td>
<td><p>G</p></td>
<td><p>H</p></td>
<td><p>I</p></td>
<td><p>J</p></td>
<td><p>K</p></td>
<td><p>L</p></td>
<td><p>M</p></td>
<td><p>N</p></td>
<td><p>O</p></td>
<td><p>P</p></td>
<td><p>Q</p></td>
<td><p>R</p></td>
<td><p>S</p></td>
<td><p>T</p></td>
<td><p>U</p></td>
<td><p>V</p></td>
<td><p>W</p></td>
<td><p>X</p></td>
<td><p>Y</p></td>
<td><p>Z</p></td>
<td><p>Espacio</p></td>
</tr>
<tr class="row-even"><td><p>Equivalente numérico</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>4</p></td>
<td><p>5</p></td>
<td><p>6</p></td>
<td><p>7</p></td>
<td><p>8</p></td>
<td><p>9</p></td>
<td><p>10</p></td>
<td><p>11</p></td>
<td><p>12</p></td>
<td><p>13</p></td>
<td><p>14</p></td>
<td><p>15</p></td>
<td><p>16</p></td>
<td><p>17</p></td>
<td><p>18</p></td>
<td><p>19</p></td>
<td><p>20</p></td>
<td><p>21</p></td>
<td><p>22</p></td>
<td><p>23</p></td>
<td><p>24</p></td>
<td><p>25</p></td>
<td><p>26</p></td>
</tr>
</tbody>
</table>
<p>Luego cada equivalente numérico (P) del mensaje original es convertido a
otro entero (C) mediante la transformación afín:</p>
<div class="math notranslate nohighlight">
\[C \equiv a \cdot P + b \quad (\text{mod } 27)\]</div>
<p>donde ‘a’ y ‘b’ son las “claves” utilizadas. Finalmente, los nuevos
números se convierten a caracteres utilizando la misma tabla. Observar
que la expresión anterior es una congruencia, por lo tanto si el entero
resultante luego de hacer a·P+b es mayor o igual a 27 (la cantidad de
caracteres con los cuales se trabaja), se utiliza el caracter de la
tabla tal que su equivalente numérico sea congruente módulo 27 con el
valor obtenido. Por otro lado, para que cada caracter se cifre a un
caracter diferente, es necesario que el entero utilizado como clave ‘a’
sea coprimo con 27, es decir, que su único común divisor sea 1.</p>
<ol class="arabic simple">
<li><p>Escriba una rutina <code class="docutils literal notranslate"><span class="pre">descifrar</span></code> que acepte como argumento el nombre
del archivo con el mensaje cifrado y el valor de las claves ‘a’ y ‘b’
y devuelva el mensaje descifrado.</p></li>
</ol>
<p>Nuestros espías han descubierto las claves utilizadas para cifrar el
mensaje del archivo <code class="docutils literal notranslate"><span class="pre">mensaje_cifrado_00.txt</span></code>. Puede utilizar este mensaje
para comprobar su algoritmo. Las claves descubiertas son</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">25</span>
</pre></div>
</div>
<p>Ejemplo de implementación (python corresponde a python3):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>descifrar.py<span class="w"> </span>mensaje_cifrado_00.txt<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">25</span>
</pre></div>
</div>
<hr class="docutils" />
<p>Desafortunadamente, para los siguientes mensajes no se tienen sus claves
de cifrado. Se le pide por lo tanto que realice un algoritmo que vulnere
al sistema y las descubra. Para ello tenga en cuenta la siguiente
observación: como cada caracter se transforma siempre al mismo caracter
cifrado, puede comparar su frecuencia de ocurrencia con las de un texto
ordinario para hallar una correspondencia.</p>
<ol class="arabic" start="2">
<li><p>Escriba una rutina <code class="docutils literal notranslate"><span class="pre">contar_letras()</span></code> que calcule la frecuencia de aparición
de cada caracter en el texto de un archivo que se le pase como
argumento. Para ello quite del texto los signos diacríticos de todas las
letras y omita los signos de puntuación y caracteres especiales, exceptuando
el caracter de espacio que sí deberá incluir en la distribución ya que este
caracter se encuentra en los mensajes cifrados.</p>
<ul class="simple">
<li><p>Utilice estas rutinas programa para generar la distribución de frecuencia
de aparición de letras en el idioma español utilizando el primer capítulo
de la novela “Don Quijote de la Mancha”, el cual puede encontrar en el
archivo <code class="docutils literal notranslate"><span class="pre">quijote_es.txt</span></code> y guarde la distribución calculada en un archivo
binario de numpy (.npy).</p></li>
<li><p>Genere una figura una figura similar a la siguiente (que puede mostrarla
por pantalla y/o guardarla como archivo):</p></li>
</ul>
<p><img alt="image0" src="_images/cripto_f1.png" /></p>
</li>
</ol>
<p>Nos ha llegado la información de que los textos cifrados pueden estar
en otros idiomas además del español. Para ello, nuestros agentes le
han conseguido traducciones de este capítulo en varios idiomas
diferentes.  Genere la distribución de frecuencia de aparición de
letras para el idioma inglés, alemán y finlandés utilizando el texto
en los archivos <code class="docutils literal notranslate"><span class="pre">quijote_en.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">quijote_de.txt</span></code> y <code class="docutils literal notranslate"><span class="pre">quijote_fi.txt</span></code>,
respectivamente. Tenga en cuenta que estos idiomas pueden poseer
signos diacríticos diferentes a los del español. Genere un archivo
<code class="docutils literal notranslate"><span class="pre">*.npy</span></code> diferente para cada idioma.</p>
<hr class="docutils" />
<p>Para descifrar los mensajes cifrados, puede hacer una correspondencia
entre los caracteres más frecuentes del texto cifrado con los más
frecuentes de cada idioma, como se observa en la siguiente figura:</p>
<p><img alt="image1" src="_images/cripto_f2.png" /></p>
<p>Eligiendo dos pares de caracteres que se consideren correspondientes
entre sí, es posible encontrar las claves ‘a’ y ‘b’ resolviendo el
siguiente sistema:</p>
<div class="math notranslate nohighlight">
\[\begin{split}C1 &amp;\equiv a \cdot P1 + b \quad \text{(mod 27)}\\
C2 &amp;\equiv a \cdot P2 + b \quad \text{(mod 27)}\end{split}\]</div>
<p>donde <span class="math notranslate nohighlight">\((C1,P1)\)</span> y <span class="math notranslate nohighlight">\((C2,P2)\)</span> son los equivalentes numéricos
de los caracteres elegidos.</p>
<p>Tenga en cuenta que la frecuencia de aparición de letras del mensaje
puede diferir levemente respecto al texto que se usa como referencia.
Por lo tanto es posible que deba probar más de una combinación de pares
<span class="math notranslate nohighlight">\((C1,P1)\)</span> y <span class="math notranslate nohighlight">\((C2,P2)\)</span> hasta dar con la correcta. Para
verificar que el mensaje se ha descifrado con éxito, puede calcular la
frecuencia de aparición de los caracteres del mensaje descifrado y
calcular su correlación con la de cada idioma. Puede utilizar para ello
el coeficiente de correlación de Pearson, función que puede encontrar en
el módulo scipy. Un valor superior a 0,8 ya debería indicar un correcto
descifrado. Este coeficiente representa cuánto se acercan los puntos a
la recta identidad en el siguiente gráfico:</p>
<p><img alt="image2" src="_images/cripto_f3.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Realice el programa <code class="docutils literal notranslate"><span class="pre">criptoanalisis.py</span></code> que descifre el mensaje utilizando
las distribuciones ya generadas de frecuencia de aparición de letras en los
diferentes idiomas. El programa deberá:</p>
<ul class="simple">
<li><p>Cargar los archivos .npy ya generados (no vuelva a generar las
distribuciones).</p></li>
<li><p>Obtener la frecuencia de aparición de letras del mensaje cifrado y
compararla con la de cada idioma.</p></li>
<li><p>Para cada idioma, elegir dos pares de caracteres y utilizarlos
para encontrar las claves ‘a’ y ‘b’.</p></li>
<li><p>Para cada idioma, descifrar el mensaje con las claves obtenidas y
calcular la frecuencia de aparición de letras del mensaje
descifrado. Hacer la correlación entre esta distribución y la del
idioma correspondiente y comprobar si alguna es superior al 80%.</p></li>
<li><p>Si ninguna correlación supera el 80%, repetir el proceso
utilizando diferentes pares de caracteres hasta encontrar las
claves correctas.</p></li>
<li><p>Imprimir en pantalla el mensaje descifrado, el idioma que mejor se
correlaciona y las claves ‘a’ y ‘b’ descubiertas.</p></li>
<li><p>Realizar un gráfico que compare los caracteres más frecuentes del
mensaje cifrado con los más frecuentes del idioma detectado,
similar al mostrado en la Figura 2.</p></li>
<li><p>Realizar otro gráfico que muestre la correlación entre la
frecuencia de aparición de letras del mensaje descifrado y la del
idioma detectado, similar al mostrado en la Figura 3.</p></li>
</ul>
</li>
</ol>
<p>Utilice este programa para descifrar los mensajes <code class="docutils literal notranslate"><span class="pre">mensaje_cifrado_01.txt</span></code>
a <code class="docutils literal notranslate"><span class="pre">mensaje_cifrado_09.txt</span></code>.</p>
<p>Ejemplo de implementación (python corresponde a python3):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>criptoanalisis.py<span class="w"> </span>mensaje_cifrado_01.txt<span class="w"> </span>--idiomas<span class="w"> </span>español<span class="w"> </span>inglés<span class="w"> </span>alemán<span class="w"> </span>finlandés
...

$<span class="w"> </span>python3<span class="w"> </span>criptoanalisis.py<span class="w"> </span>mensaje_cifrado_01.txt<span class="w"> </span>-i<span class="w"> </span>español
...
</pre></div>
</div>
<ol class="arabic" start="4">
<li><p>Elija <strong>sólo uno</strong> de los siguientes dos ejercicios:</p>
<ul class="simple">
<li><p>El centro de inteligencia quiere ser capaz de cifrar sus propios mensajes.
Se le pide para ello que realice el programa <code class="docutils literal notranslate"><span class="pre">cifrar.py</span></code> que tome un
texto normal cualquiera y lo cifre utilizando claves ‘a’ y ‘b’ pasadas como
argumento. El mensaje devuelto tiene que ser descifrable mediante el
programa del punto 1 utilizando las mismas claves ‘a’ y ‘b’.  El programa
debe dar un mensaje de error si la clave a proporcionada es inválida (no es
cooprima con 27).</p></li>
</ul>
<p>Ejemplos de implementación con a=1 y b=3 (python corresponde a python3):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>cifrar.py<span class="w"> </span>mensaje.txt<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span>
...

$<span class="w"> </span>python<span class="w"> </span>cifrar.py<span class="w"> </span>mensaje.txt<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span>-o<span class="w"> </span>mensaje_cifrado.txt
...
</pre></div>
</div>
<ul class="simple">
<li><p>Nuestros espías han interceptado un mensaje muy peculiar que, aunque se
sabe que está en español, no puede ser descifrado utilizando la técnica
anteriormente expuesta debido a alguna peculiaridad del mensaje. El mismo
se encuentra en el archivo <code class="docutils literal notranslate"><span class="pre">mensaje_cifrado_10.txt</span></code>. Es capaz de
descifrarlo?</p></li>
</ul>
</li>
</ol>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Los datos se encuentran en cualquiera de los dos archivos
comprimidos <em>mensajes_cifrados.tar.gz</em> y <em>mensajes_cifrados.zip</em>
<a class="reference external" href="https://drive.google.com/drive/folders/1QPfXnk7rBGXmsxvxiiItg6hEkglZMnaZ?usp=share_link">en data</a>.</p>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="ej_manejodatos.html" class="btn btn-neutral float-left" title="Manejo y análisis de datos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="lineamientos.html" class="btn btn-neutral float-right" title="Modalidad del examen" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor Cátedra IB.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>